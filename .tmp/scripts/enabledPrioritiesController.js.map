{"version":3,"sources":["../../app/scripts/enabledPrioritiesController.js"],"names":[],"mappings":"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","file":"enabledPrioritiesController.js","sourcesContent":["/*old-jslint indent: 2, unparam: true, plusplus: true */\r\n/*\r\njslint\r\n    devel: true,\r\n    browser: true,\r\n    node: false\r\n*/\r\n/*\r\nglobal\r\n    $,\r\n    validationStepPercent,\r\n    deferred: true,\r\n    options: true\r\n*/\r\n\r\nvar enabledPrioritiesModule = (function () {\r\n    'use strict';\r\n    \r\n    var options = {\r\n        sortable: {\r\n            connectWith: 'ul',\r\n            cursor: 'move',\r\n            forcePlaceholderSize: true,\r\n            handle: ':not(.disabled)',\r\n            helper: 'clone',\r\n            items: '> li:not(.disabled)', // > li:visible:not(.disabled)\r\n            opacity: 0.8,\r\n            placeholder: 'ui-sortable-placeholder',\r\n            revert: true,\r\n            scroll: true,\r\n            tolerance: 'pointer'\r\n            // axis: 'y',\r\n            // start: function (event, ui) {\r\n            //  $(this).parent().children('.ui-sortable-placeholder').height( $(this).height() );\r\n            // },\r\n            // containment: 'parent', // parent document window or a selector\r\n            // grid: [ 40, 40 ],\r\n            // cancel: '.disabled',\r\n        },\r\n        cookieExpires: 30\r\n    };\r\n\r\n    /**\r\n     * Save positions to cookies\r\n     */\r\n    var _saveCookies = function (ids) { \r\n\r\n        $.cookie('enabled_priorities', ids.join(','), {\r\n            expires: options.cookieExpires\r\n        });\r\n        \r\n        console.log('enabled_priorities saved to cookies: ' + $.cookie('enabled_priorities'));\r\n        \r\n    };\r\n\r\n    $(function () {\r\n            \r\n        // var template = Handlebars.compile(source);\r\n        // $('[data-anchor=\"enabled_priorities\"]').html(template({}));\r\n\r\n        // appModule.initBlock('[data-anchor=\"enabled_priorities\"]');\r\n\r\n        var $el = $('#enabled_priorities');\r\n\r\n        // On sortable priorities change\r\n        $el\r\n            .sortable(options.sortable)\r\n            .disableSelection()\r\n            .on('sortstop sortreceive sortremove', function () { // event, ui\r\n                var ids = $(this).sortable('toArray');\r\n\r\n                //_saveCookies(ids);\r\n                $('#stored_priorities').val(ids.join(',')).trigger('change');\r\n\r\n                // Make some profile fields required if needed by user priorities\r\n                $.each(ids, function (i, value) {\r\n                    if (value === 'speaking_language_priority') {\r\n                        $('#user_speaking_languages').prop('required', true);\r\n                    }\r\n                    if (value === 'reading_language_priority') {\r\n                        $('#user_reading_languages').prop('required', true);\r\n                    }\r\n                    if (value === 'visa_free_priority') {\r\n                        $('#user_citizenships').prop('required', true);\r\n                    }\r\n                    if (value === 'currency_priority' || value === 'change_rate_priority') {\r\n                        $('#user_currencies').prop('required', true);\r\n                    }\r\n                    if (value === 'ac_plugs_priority' || value === 'ac_voltages_priority') {\r\n                        $('#user_plug_types').prop('required', true);\r\n                        $('#user_plug_voltages').prop('required', true);\r\n                    }\r\n                    if (value === 'income_level_priority') {\r\n                        $('#user_income_level').prop('required', true);\r\n                    }\r\n                });\r\n\r\n                // Toggle #disable_selected_priorities button visibility\r\n                if ($el.find('li.active:visible').length > 0) {\r\n                    $('#disable_selected_priorities').removeClass('disabled');\r\n                } else {\r\n                    $('#disable_selected_priorities').addClass('disabled');\r\n                }\r\n\r\n\r\n                if (ids.length > 0) {\r\n                    // Toggle #disable_selected_priorities button visibility\r\n                    $('#disable_all_priorities').removeClass('disabled');\r\n                    $('#no_priority_alert').hide();\r\n                    // $('a[href=\"#disabled_priorities_modal\"]').removeClass('btn-primary');\r\n                    // Step 2 success\r\n                    // alert('prioritiesController');\r\n                    appModule.validationStepPercent(1, 100);\r\n                } else {\r\n                    $('#disable_all_priorities').addClass('disabled');\r\n                    $('#disable_selected_priorities').addClass('disabled');\r\n                    $('#no_priority_alert').fadeIn();\r\n                    // $('a[href=\"#disabled_priorities_modal\"]').addClass('btn-primary');\r\n                    // Step 2 failed\r\n                    // alert('prioritiesController');\r\n                    appModule.validationStepPercent(1, 0);\r\n                }\r\n\r\n            });\r\n\r\n        // Disable selected button\r\n        $('#disable_selected_priorities').on('click', function (e) {\r\n            e.preventDefault();\r\n            var array = [];\r\n            $.each($el.find('li.active:visible'), function () { // i, id\r\n                $(this).removeClass('active');\r\n                $(this).find('.glyphicon-remove').removeClass('glyphicon-remove').addClass('glyphicon-plus');\r\n                array.push($(this));\r\n            });\r\n            $('#disabled_priorities').append(array).trigger('sortreceive');\r\n            $el.trigger('sortremove');\r\n            // Trigger a change on the filter to rearrange new disabled priorities\r\n            $('#priority_filters').trigger('change');\r\n        });\r\n\r\n        // Disable all button\r\n        $('#disable_all_priorities').on('click', function (e) {\r\n            e.preventDefault();\r\n            var array = [];\r\n            $.each($el.find('li:visible'), function () { // i, id\r\n                $(this).removeClass('active');\r\n                $(this).find('.glyphicon-remove').removeClass('glyphicon-remove').addClass('glyphicon-plus');\r\n                array.push($(this));\r\n            });\r\n            $('#disabled_priorities').append(array).trigger('sortreceive');\r\n            $el.trigger('sortremove');\r\n            // Trigger a change on the filter to rearrange new disabled priorities\r\n            $('#priority_filters').trigger('change');\r\n        });\r\n\r\n        // Disable button\r\n        $el.on('click', '.switch-priority', function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            var $block = $(this).closest('.list-group-item');\r\n            $block\r\n                .removeClass('active')\r\n                .removeAttr('style');\r\n            $(this).find('.glyphicon-remove').removeClass('glyphicon-remove').addClass('glyphicon-plus');\r\n            $('#disabled_priorities').append($block).trigger('sortreceive');\r\n            $el.trigger('sortremove');\r\n        });\r\n\r\n        // Highlight sortable item when user click it\r\n        $el.on('click', 'li:not(.disabled)', function () {\r\n            $(this).toggleClass('active');\r\n\r\n            // Toggle #disable_selected_priorities button visibility\r\n            if ($el.find('li.active:visible').length > 0) {\r\n                $('#disable_selected_priorities').removeClass('disabled');\r\n            } else {\r\n                $('#disable_selected_priorities').addClass('disabled');\r\n            }\r\n\r\n        });\r\n\r\n        appModule.deferred.ready.enabledPriorities.resolve();\r\n        \r\n    });\r\n\r\n})();\r\n\r\n"]}