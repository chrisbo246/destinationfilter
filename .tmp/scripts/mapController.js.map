{"version":3,"sources":["../../app/scripts/mapController.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAeA,IAAI,SAAS,GAAG,CAAC,YAAY;AACzB,gBAAY,CAAC;;AAEb,WAAO,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;AAuBhC,QAAI,MAAM,GAAG,SAAT,MAAM,GAAe;AACrB,WAAG,CAAC,MAAM,EAAE,CAAC;KAChB,CAAA;;;;;AAOD,QAAI,SAAS,GAAG,SAAZ,SAAS,CAAa,SAAS,EAAE,QAAQ,EAAE,IAAI,EAAE;;AAEjD,YAAI,IAAI,GAAG,GAAG,CAAC,OAAO,EAAE,CAAC;AACzB,YAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,SAAS,EAAE,QAAQ,CAAC,EAAE,WAAW,EAAE,WAAW,CAAC,CAAC,CAAC;AACnF,YAAI,IAAI,EAAE;AACN,gBAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;SACtB;AACD,eAAO,CAAC,GAAG,CAAC,6BAA6B,GAAG,SAAS,GAAG,aAAa,GAAG,QAAQ,GAAG,SAAS,GAAG,IAAI,CAAC,CAAC;KACxG,CAAA;;;;;;AAQD,QAAI,UAAU,GAAG,SAAb,UAAU,CAAa,EAAE,EAAE;;;AAG3B,YAAI,MAAM,GAAG,eAAe,CAAC;AAC7B,YAAI,OAAO,GAAG,MAAM,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;AACxC,YAAI,OAAO,wCAA0C,OAAO,CAAC,WAAW,EAAE,AAAC,CAAC;AAC5E,YAAI,IAAI,yBAA2B,GAAG,CAAC,OAAO,EAAE,AAAC,CAAC;AAClD,YAAI,IAAI,GAAG,GAAG,CAAC,OAAO,EAAE,CAAC;AACzB,YAAI,CAAC,WAAW,CACZ,OAAO,EACP,IAAI,EACJ;AACE,mBAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;AACrB,+BAAmB,EAAE,KAAK;;;SAG3B,CACJ,CAAC;KACL,CAAA;;;;;AAOD,QAAI,wBAAwB,GAAG,SAA3B,wBAAwB,CAAa,OAAO,EAAE;;AAC9C,YAAI,OAAO;YACP,KAAK,GAAG,CAAC;YACT,EAAE,GAAG,OAAO,CAAC,KAAK,EAAE,CAAC;;AAEzB,YAAI,SAAS,CAAC,aAAa,IAAI,SAAS,CAAC,gBAAgB,CAAC,EAAE,CAAC,EAAE;AAC3D,cAAE,GAAG,SAAS,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAC,WAAW,EAAE,CAAC;AAClD,gBAAI,SAAS,CAAC,aAAa,CAAC,EAAE,CAAC,IAAI,SAAS,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,OAAO,EAAE;AACpE,qBAAK,GAAG,SAAS,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC;;aAE/C;SACJ;;AAED,eAAO,GAAG,AAAC,CAAC,KAAK,IAAI,CAAC,CAAA,GAAI,GAAG,GAAI,GAAG,CAAC;;AAErC,YAAI,KAAK,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC;AAC3B,gBAAI,EAAE,IAAI,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC;AACpB,qBAAK,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,OAAO,CAAC;;aAErC,CAAC;;;;;SAKL,CAAC,CAAC;;AAEH,eAAO,CAAC,KAAK,CAAC,CAAC;KAElB,CAAC;;;;;AAOF,QAAI,wBAAwB,GAAG,SAA3B,wBAAwB,CAAa,OAAO,EAAE;;AAC9C,YAAI,OAAO;YACP,kBAAkB,GAAG,CAAC;YACtB,EAAE,GAAG,OAAO,CAAC,KAAK,EAAE,CAAC;;AAEzB,YAAI,SAAS,CAAC,aAAa,IAAI,SAAS,CAAC,gBAAgB,CAAC,EAAE,CAAC,EAAE;AAC3D,cAAE,GAAG,SAAS,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAC,WAAW,EAAE,CAAC;AAClD,gBAAI,SAAS,CAAC,aAAa,CAAC,EAAE,CAAC,IAAI,SAAS,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,kBAAkB,EAAE;AAC/E,kCAAkB,GAAG,SAAS,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,kBAAkB,CAAC;;aAEvE;SACJ;;AAED,eAAO,GAAG,AAAC,CAAC,kBAAkB,IAAI,CAAC,CAAA,GAAI,GAAG,GAAI,GAAG,CAAC;;AAElD,YAAI,KAAK,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC;AAC3B,gBAAI,EAAE,IAAI,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC;AACpB,qBAAK,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,OAAO,CAAC;aACrC,CAAC;;;;;SAKL,CAAC,CAAC;;AAEH,eAAO,CAAC,KAAK,CAAC,CAAC;KAClB,CAAC;;;;;AAOF,QAAI,kBAAkB,GAAG,SAArB,kBAAkB,CAAa,OAAO,EAAE,UAAU,EAAE;AACpD,YAAI,OAAO,EACP,SAAS,EACT,OAAO,EACP,kBAAkB,EAClB,EAAE,CAAC;;AAEP,eAAO,GAAG,CAAC,CAAC;AACZ,0BAAkB,GAAG,CAAC,CAAC;AACvB,UAAE,GAAG,OAAO,CAAC,KAAK,EAAE,CAAC;AACrB,YAAI,SAAS,CAAC,aAAa,IAAI,SAAS,CAAC,gBAAgB,CAAC,EAAE,CAAC,EAAE;AAC3D,cAAE,GAAG,SAAS,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAC,WAAW,EAAE,CAAC;AAClD,gBAAI,SAAS,CAAC,aAAa,CAAC,EAAE,CAAC,IAAI,SAAS,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,OAAO,EAAE;AACpE,uBAAO,GAAG,SAAS,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC;aACjD;;AAED,gBAAI,SAAS,CAAC,aAAa,CAAC,EAAE,CAAC,IAAI,SAAS,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,kBAAkB,EAAE;AAC/E,kCAAkB,GAAG,SAAS,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC,kBAAkB,CAAC;aACvE;SACJ;;AAED,eAAO,GAAG,AAAC,CAAC,OAAO,IAAI,CAAC,CAAA,GAAI,GAAG,GAAI,GAAG,GAAG,GAAG,CAAC;AAC7C,iBAAS,GAAI,AAAC,CAAC,kBAAkB,IAAI,CAAC,CAAA,GAAI,GAAG,GAAI,CAAC,CAAC;;AAEnD,YAAI,KAAK,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC;AAC3B,gBAAI,EAAE,IAAI,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC;AACpB,oBAAI,EAAE,gCAAgC;AACtC,oBAAI,EAAE,IAAI,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC;AACpB,yBAAK,EAAE,CAAC,GAAG,GAAG,SAAS,EAAE,EAAE,GAAG,SAAS,EAAE,CAAC,EAAE,OAAO,CAAC;iBACvD,CAAC;AACF,sBAAM,EAAE,IAAI,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC;AACxB,yBAAK,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,OAAO,GAAG,GAAG,CAAC;AACrC,yBAAK,EAAE,CAAC;iBACX,CAAC;aACL,CAAC;SACL,CAAC,CAAC;;AAEH,YAAI,OAAO,IAAI,CAAC,EAAE;AACd,iBAAK,CAAC,OAAO,EAAE,CAAC,OAAO,CAAC,UAAU,GAAG,GAAG,GAAG,OAAO,CAAC,OAAO,EAAE,GAAG,GAAG,GAAG,EAAE,CAAC,CAAC;SAC5E;;AAED,eAAO,CAAC,KAAK,CAAC,CAAC;KAClB,CAAC;;;AAKF,QAAI,kBAAkB,GAAG,eAAe,CAAC,MAAM,CAAC,eAAe,EAAE,EAAC,OAAO,EAAE,IAAI,EAAC,CAAC,CAAC;AAClF,QAAI,iBAAiB,GAAG,eAAe,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;AAC/D,QAAI,eAAe,GAAG,eAAe,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;AAC3D,QAAI,gBAAgB,GAAG,eAAe,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;AAC7D,QAAI,gBAAgB,GAAG,eAAe,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;AAC7D,QAAI,WAAW,GAAG,eAAe,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;AACnD,QAAI,4BAA4B,GAAG,eAAe,CAAC,MAAM,CAAC,yBAAyB,CAAC,CAAC;;;AAGrF,QAAI,gBAAgB,GAAG,eAAe,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;AAC7D,QAAI,kBAAkB,GAAG,eAAe,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;AACjE,QAAI,iBAAiB,GAAG,eAAe,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;AAC/D,QAAI,cAAc,GAAG,eAAe,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;AACzD,QAAI,YAAY,GAAG,eAAe,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;AACrD,mBAAe,CAAC,aAAa,CAAC,gBAAgB,EAAE,YAAY,CAAC,CAAC;;AAE9D,QAAI,kBAAkB,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC;AACvC,YAAI,EAAE,SAAS;AACf,aAAK,EAAE,aAAa;AACpB,eAAO,EAAE,KAAK;KACjB,CAAC,CAAC;;;AAGH,QAAI,YAAY,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC;AAClC,YAAI,EAAE,cAAc;AACpB,cAAM,EAAE,CACJ,gBAAgB,EAChB,iBAAiB,EACjB,kBAAkB,CACrB;KACJ,CAAC,CAAC;;AAEH,QAAI,mBAAmB,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC;AACzC,YAAI,EAAE,qBAAqB;AAC3B,cAAM,EAAE,CACJ,cAAc,EACd,YAAY,CACf;KACJ,CAAC,CAAC;;AAEH,QAAI,eAAe,GAAG,IAAI,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC;AACvC,WAAG,EAAE,wBAAwB;AAC7B,cAAM,EAAE,IAAI,EAAE,CAAC,MAAM,CAAC,OAAO,EAAE;KAClC,CAAC,CAAC;;AAEH,QAAI,WAAW,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC;AAClC,YAAI,EAAE,QAAQ;AACd,aAAK,EAAE,QAAQ;AACf,eAAO,EAAE,IAAI;AACb,qBAAa,EAAE,GAAG;AAClB,cAAM,EAAE,eAAe;KAC1B,CAAC,CAAC;;AAEH,QAAI,iBAAiB,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC;AACxC,YAAI,EAAE,cAAc;AACpB,aAAK,EAAE,iBAAiB;AACxB,eAAO,EAAE,IAAI;AACb,qBAAa,EAAE,GAAG;AAClB,cAAM,EAAE,eAAe;KAC1B,CAAC,CAAC;;AAEH,QAAI,gBAAgB,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC;AACvC,YAAI,EAAE,aAAa;AACnB,aAAK,EAAE,cAAc;AACrB,eAAO,EAAE,KAAK;AACd,qBAAa,EAAE,GAAG;AAClB,cAAM,EAAE,eAAe;KAC1B,CAAC,CAAC;;;AAGH,QAAI,cAAc,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC;AACpC,YAAI,EAAE,gBAAgB;AACtB,cAAM,EAAE,CACJ,eAAe,EACf,iBAAiB,EACjB,gBAAgB,EAChB,kBAAkB,CACrB;KACJ,CAAC,CAAC;;AAEH,QAAI,gBAAgB,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC;AACtC,YAAI,EAAE,kBAAkB;AACxB,cAAM,EAAE,CACJ,4BAA4B,EAC5B,WAAW,CACd;KACJ,CAAC,CAAC;;AAEH,QAAI,gBAAgB,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC;AACtC,YAAI,EAAE,kBAAkB;AACxB,cAAM,EAAE,CACJ,gBAAgB,CACnB;KACJ,CAAC,CAAC;;AAEH,QAAI,UAAU,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC;AAChC,YAAI,EAAE,YAAY;AAClB,cAAM,EAAE,CACJ,gBAAgB,EAChB,gBAAgB,EAChB,cAAc,CACjB;KACJ,CAAC,CAAC;;AAEH,QAAI,YAAY,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC;AAClC,YAAI,EAAE,cAAc;AACpB,cAAM,EAAE,CACJ,iBAAiB,EACjB,gBAAgB,EAChB,WAAW,CACd;KACJ,CAAC,CAAC;;AAEH,QAAI,QAAQ,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC;AAC9B,YAAI,EAAE,UAAU;AAChB,cAAM,EAAE,CACJ,YAAY;;;AAGZ,2BAAmB;;AAEnB,oBAAY,CACf;KACJ,CAAC,CAAC;;AAEH,QAAI,MAAM,GAAG,CACL,UAAU,EACV,QAAQ;;KAEX,CAAC;;AAEN,aAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;;AAI7C,QAAI,GAAG,CAAC;;;;AAIR,QAAI,UAAU,GAAG,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;;;;;AAK1C,QAAI,MAAM,GAAG,UAAU,CAAC,SAAS,EAAE,CAAC;;;AAGpC,QAAI,MAAM,GAAG,EAAE,CAAC,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;;AAEzC,QAAI,IAAI,GAAG,IAAI,EAAE,CAAC,IAAI,CAAC;AACnB,cAAM,EAAE,MAAM;AACd,cAAM,EAAE,MAAM;AACd,qBAAa,EAAE,QAAQ;AACvB,kBAAU,EAAE,UAAU;AACtB,YAAI,EAAE,CAAC;;;;;KAKV,CAAC,CAAC;;AAEH,KAAC,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,WAAW,EAAE,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,eAAe,EAAE,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,SAAS,EAAE,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,YAAY;AAC9K,SAAC,CAAC,YAAY;;;;;;;AAOV,gBAAI,UAAU,GAAG,QAAQ,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;;;;;AAKhD,eAAG,GAAG,IAAI,EAAE,CAAC,GAAG,CAAC;AACb,oBAAI,EAAE,KAAK;AACX,oBAAI,EAAE,IAAI;AACV,wBAAQ,EAAE,iBAAiB,CAAC,QAAQ;AACpC,4BAAY,EAAE,qBAAqB,CAAC,YAAY;AAChD,sBAAM,EAAE,MAAM;AACd,wBAAQ,EAAE,iBAAiB,CAAC,QAAQ;;AAEpC,sBAAM,EAAE,UAAU;AAClB,yCAAyB,EAAE,IAAI;aAClC,CAAC,CAAC;;AAEH,gBAAI,WAAW,GAAG,QAAQ,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC;;AAEtD,gBAAI,CAAC,EAAE,CAAC,GAAG,CAAC,KAAK,EAAE;AACf,2BAAW,CAAC,KAAK,CAAC,OAAO,GAAG,EAAE,CAAC;;aAElC,MAAM,EAEN;;;;AAAA,AAGD,aAAC,CAAC,sBAAsB,CAAC,CAAC,EAAE,CAAC,cAAc,EAAE,UAAU,CAAC,EAAE;AACtD,oBAAI,OAAO,GAAG,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;AACvC,oBAAI,OAAO,KAAK,WAAW,EAAE;;;;AAIrB,+BAAW,CAAC,YAAY,EAAE,CAAC;AAC3B,uBAAG,CAAC,UAAU,EAAE,CAAC;AACjB,+BAAW,CAAC,OAAO,EAAE,CAAC;AACtB,qCAAiB,CAAC,OAAO,EAAE,CAAC;;;;AAI5B,qCAAiB,CAAC,kBAAkB,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;AAC3D,2BAAO,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;;iBAGpC;aACJ,CAAC,CAAC;;;AAGH,aAAC,CAAC,yFAAyF,CAAC,CAAC,OAAO,CAAC;AACjG,yBAAS,EAAE,OAAO;aACrB,CAAC,CAAC;AACH,aAAC,CAAC,+GAA+G,CAAC,CAAC,OAAO,CAAC;AACvH,yBAAS,EAAE,MAAM;aACpB,CAAC,CAAC;AACH,aAAC,CAAC,wBAAwB,CAAC,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;;;;;;;;AAUnD,qBAAS,CAAC,GAAG,GAAG,GAAG,CAAC;;AAEpB,qBAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC;AACvC,mBAAO,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC;SAEtC,CAAC,CAAC;KACN,CAAC,CAAC;;;AAGH,KAAC,CAAC,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC,IAAI,CAAC,YAAY;;AAE7C,mBAAW,CAAC,aAAa,CAAC;AACtB,iBAAK,EAAE,kBAAkB;SAC5B,CAAC,CAAC;;AAEH,yBAAiB,CAAC,aAAa,CAAC;AAC5B,iBAAK,EAAE,wBAAwB;SAClC,CAAC,CAAC;;AAEH,wBAAgB,CAAC,aAAa,CAAC;AAC3B,iBAAK,EAAE,wBAAwB;SAClC,CAAC,CAAC;;AAEH,eAAO,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAC;KAErC,CAAC,CAAC;;;AAKH,KAAC,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,YAAY;;AAErD,sBAAc,CAAC,aAAa,CAAC;AACzB,iBAAK,EAAE,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,2BAA2B,CAAC;SACvD,CAAC,CAAC;;AAEH,wBAAgB,CAAC,aAAa,CAAC;AAC3B,iBAAK,EAAE,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,qCAAqC,CAAC;SACjE,CAAC,CAAC;;AAEH,wBAAgB,CAAC,aAAa,CAAC;AAC3B,iBAAK,EAAE,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,gCAAgC,CAAC;SAC5D,CAAC,CAAC;;AAEH,kBAAU,CAAC,aAAa,CAAC;AACrB,iBAAK,EAAE,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,0BAA0B,CAAC;SACtD,CAAC,CAAC;;AAEH,oBAAY,CAAC,aAAa,CAAC;AACvB,iBAAK,EAAE,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,2BAA2B,CAAC;SACvD,CAAC,CAAC;;AAEH,2BAAmB,CAAC,aAAa,CAAC;AAC9B,iBAAK,EAAE,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,2BAA2B,CAAC;SACvD,CAAC,CAAC;;;;;;AAMH,oBAAY,CAAC,aAAa,CAAC;AACvB,iBAAK,EAAE,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,yBAAyB,CAAC;SACrD,CAAC,CAAC;;AAEH,gBAAQ,CAAC,aAAa,CAAC;AACnB,iBAAK,EAAE,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,8BAA8B,CAAC;SAC1D,CAAC,CAAC;;AAEH,2BAAmB,CAAC,aAAa,CAAC;AAC9B,iBAAK,EAAE,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,2BAA2B,CAAC;SACvD,CAAC,CAAC;;AAEH,eAAO,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;;;;;KAMxC,CAAC,CAAC;;AAIH,KAAC,CAAC,YAAY;;AAEV,SAAC,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,YAAY;;AAElD,2BAAe,CAAC,IAAI,CAAC,OAAO,EAAE,SAAS,CAAC,GAAG,CAAC,CAAC;AAC7C,2BAAe,CAAC,UAAU,CAAC,aAAa,EAAE,SAAS,CAAC,GAAG,CAAC,CAAC;AACzD,2BAAe,CAAC,QAAQ,CAAC,WAAW,EAAE,SAAS,CAAC,GAAG,CAAC,CAAC;AACrD,2BAAe,CAAC,MAAM,CAAC,WAAW,EAAE,WAAW,EAAE,SAAS,CAAC,GAAG,CAAC,CAAC;AAChE,2BAAe,CAAC,SAAS,CAAC,aAAa,EAAE,SAAS,CAAC,GAAG,CAAC,CAAC;;;AAGxD,gBAAI,QAAQ,GAAG,CAAC,CAAC,WAAW,CAAC,CAAC;AAC9B,oBAAQ,CAAC,EAAE,CAAC,mCAAmC,EAAE,YAAY;;AACzD,oBAAI,IAAI,CAAC,OAAO,EAAE;AACd,wBAAI,IAAI,GAAG,SAAS,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC;AACnC,wBAAI,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;AACjB,2BAAO,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;iBACjC;aACJ,CAAC,CAAC;SAEN,CAAC,CAAC;KAEN,CAAC,CAAC;;AAIH,WAAO;AACH,WAAG,EAAE,GAAG;AACR,cAAM,EAAE,MAAM;AACd,iBAAS,EAAE,SAAS;AACpB,kBAAU,EAAE,UAAU;KACzB,CAAC;CAEL,CAAA,EAAG,CAAC","file":"mapController.js","sourcesContent":["/*old-jslint indent: 2, unparam: true, plusplus: true */\r\n/*\r\njslint\r\n    devel: true,\r\n    browser: true,\r\n    node: false\r\n*/\r\n/*\r\nglobal\r\n    $,\r\n    ol,\r\n    updateScores,\r\n    deferred: true,\r\n*/\r\n\r\nvar mapModule = (function () {\r\n    'use strict'; \r\n   \r\n    console.time('Map initialized');\r\n    \r\n    // Features\r\n    /*\r\n    positionFeature.setStyle(new ol.style.Style({\r\n        image: new ol.style.Circle({\r\n            radius: 6,\r\n            fill: new ol.style.Fill({\r\n                color: '#3399CC'\r\n            }),\r\n            stroke: new ol.style.Stroke({\r\n                color: '#fff',\r\n                width: 2\r\n            })\r\n        })\r\n    }));\r\n    */\r\n    \r\n    \r\n    \r\n    /**\r\n     * geolocation-orientation\r\n     */\r\n    var render = function () {\r\n        map.render();\r\n    }\r\n    \r\n    \r\n    \r\n    /**\r\n     * Center map at a GPS position\r\n     */\r\n    var centerMap = function (longitude, latitude, zoom) {\r\n        \r\n        var view = map.getView();\r\n        view.setCenter(ol.proj.transform([longitude, latitude], 'EPSG:4326', 'EPSG:3857'));\r\n        if (zoom) {\r\n            view.setZoom(zoom);\r\n        }\r\n        console.log('Map centered at longitude: ' + longitude + ' latitude: ' + latitude + ' zoom: ' + zoom);\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * Center the map on a country and adjust zoom\r\n     * See http://openlayers.org/en/v3.4.0/examples/center.html\r\n     */\r\n    var fitCountry = function (id) {\r\n        \r\n        //var feature = source.getFeatures()[0];\r\n        var source = countriesSource;\r\n        var feature = source.getFeatureById(id);\r\n        var polygon = /** @type {ol.geom.SimpleGeometry} */ (feature.getGeometry());\r\n        var size = /** @type {ol.Size} */ (map.getSize());\r\n        var view = map.getView();\r\n        view.fitGeometry(\r\n            polygon,\r\n            size,\r\n            {\r\n              padding: [0, 0, 0, 0],\r\n              constrainResolution: false\r\n              // nearest: true,\r\n              // minResolution: 50\r\n            }\r\n        );\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * Destinations layer style\r\n     */\r\n    var destinationStyleFunction = function (feature) { // feature, resolution\r\n        var opacity,\r\n            score = 0,\r\n            id = feature.getId(); // ISO2 lower case\r\n        \r\n        if (appModule.countriesData && appModule.countryCodesISO2[id]) {\r\n            id = appModule.countryCodesISO2[id].toLowerCase(); // ISO3 lower case\r\n            if (appModule.countriesData[id] && appModule.countriesData[id].percent) {\r\n                score = appModule.countriesData[id].percent;\r\n                // score = appModule.countriesData[id].score / appModule.countriesData[id].scoreMax * 100;\r\n            }\r\n        }\r\n\r\n        opacity = ((score || 0) / 100) * 0.8;\r\n\r\n        var style = new ol.style.Style({\r\n            fill: new ol.style.Fill({\r\n                color: [0x33, 0xff, 0x00, opacity]\r\n                // color: [0xff, 0x33, 0x00, opacity]\r\n            })/*,\r\n            stroke: new ol.style.Stroke({\r\n                color: '#319FD3',\r\n                width: 1\r\n            })*/\r\n        });\r\n\r\n        return [style];\r\n        \r\n    };\r\n\r\n\r\n\r\n    /**\r\n     * Missing data layer style\r\n     */\r\n    var missingDataStyleFunction = function (feature) { // feature, resolution\r\n        var opacity,\r\n            missingDataPercent = 0,\r\n            id = feature.getId(); // ISO2 lower case\r\n\r\n        if (appModule.countriesData && appModule.countryCodesISO2[id]) {\r\n            id = appModule.countryCodesISO2[id].toLowerCase(); // ISO3 lower case\r\n            if (appModule.countriesData[id] && appModule.countriesData[id].missingDataPercent) {\r\n                missingDataPercent = appModule.countriesData[id].missingDataPercent;\r\n                // score = appModule.countriesData[id].score / appModule.countriesData[id].scoreMax * 100;\r\n            }\r\n        }\r\n\r\n        opacity = ((missingDataPercent || 0) / 100) * 0.8;\r\n\r\n        var style = new ol.style.Style({\r\n            fill: new ol.style.Fill({\r\n                color: [0x88, 0x88, 0x88, opacity]\r\n            })/*,\r\n            stroke: new ol.style.Stroke({\r\n                color: '#319FD3',\r\n                width: 1\r\n            })*/\r\n        });\r\n\r\n        return [style];\r\n    };\r\n\r\n\r\n\r\n    /**\r\n     * Score layer style\r\n     */\r\n    var scoreStyleFunction = function (feature, resolution) {\r\n        var opacity,\r\n            intensity,\r\n            percent,\r\n            missingDataPercent,\r\n            id;\r\n\r\n        percent = 0;\r\n        missingDataPercent = 0;\r\n        id = feature.getId(); // ISO2 lower case\r\n        if (appModule.countriesData && appModule.countryCodesISO2[id]) {\r\n            id = appModule.countryCodesISO2[id].toLowerCase(); // ISO3 lower case\r\n            if (appModule.countriesData[id] && appModule.countriesData[id].percent) {\r\n                percent = appModule.countriesData[id].percent;\r\n            }\r\n\r\n            if (appModule.countriesData[id] && appModule.countriesData[id].missingDataPercent) {\r\n                missingDataPercent = appModule.countriesData[id].missingDataPercent;\r\n            }\r\n        }\r\n\r\n        opacity = ((percent || 0) / 100) * 0.6 + 0.4;\r\n        intensity =  ((missingDataPercent || 0) / 100) * 1;\r\n\r\n        var style = new ol.style.Style({\r\n            text: new ol.style.Text({\r\n                font: '1.25em bold Calibri,sans-serif',\r\n                fill: new ol.style.Fill({\r\n                    color: [168 * intensity, 84 * intensity, 0, opacity]\r\n                }),\r\n                stroke: new ol.style.Stroke({\r\n                    color: [255, 255, 255, opacity * 0.5],\r\n                    width: 1\r\n                })\r\n            })\r\n        });\r\n\r\n        if (percent >= 0) {\r\n            style.getText().setText(resolution > 300 ? percent.toFixed() + '%' : '');\r\n        }\r\n\r\n        return [style];\r\n    };\r\n    \r\n    \r\n    \r\n    // Base layers\r\n    var openStreetMapLayer = mapLayersModule.create('openStreetMap', {visible: true});\r\n    var openCycleMapLayer = mapLayersModule.create('openCycleMap');\r\n    var openSeaMapLayer = mapLayersModule.create('openSeaMap');\r\n    var mapquestOSMLayer = mapLayersModule.create('mapquestOSM');\r\n    var mapquestSatLayer = mapLayersModule.create('mapquestSat'); \r\n    var arcgisLayer = mapLayersModule.create('arcgis');    \r\n    var stamenTerrainWithLabelsLayer = mapLayersModule.create('stamenTerrainWithLabels');\r\n    \r\n    // Overlays\r\n    var mapquestHybLayer = mapLayersModule.create('mapquestHyb');\r\n    var lonviaCyclingLayer = mapLayersModule.create('lonviaCycling');\r\n    var lonviaHikingLayer = mapLayersModule.create('lonviaHiking');\r\n    var timeZonesLayer = mapLayersModule.create('timeZones');\r\n    var gpxFileLayer = mapLayersModule.create('gpxFile');\r\n    mapLayersModule.GPXFileSource('#gpx_file_path', gpxFileLayer);\r\n\r\n    var drawingVectorLayer = new ol.layer.Tile({\r\n        name: 'drawing',\r\n        title: 'My drawings',\r\n        visible: false\r\n    });\r\n\r\n    // Groups\r\n    var roadOverlays = new ol.layer.Group({\r\n        name: 'roadOverlays',\r\n        layers: [\r\n            mapquestHybLayer,\r\n            lonviaHikingLayer,\r\n            lonviaCyclingLayer\r\n        ]\r\n    });\r\n\r\n    var informationOverlays = new ol.layer.Group({\r\n        name: 'informationOverlays',\r\n        layers: [\r\n            timeZonesLayer,\r\n            gpxFileLayer\r\n        ]\r\n    });   \r\n\r\n    var countriesSource = new ol.source.Vector({\r\n        url: 'data/countries.geojson',\r\n        format: new ol.format.GeoJSON()\r\n    });\r\n    \r\n    var scoresLayer = new ol.layer.Vector({\r\n        name: 'scores',\r\n        title: 'Scores',\r\n        visible: true,\r\n        minResolution: 200,\r\n        source: countriesSource\r\n    });\r\n\r\n    var destinationsLayer = new ol.layer.Vector({\r\n        name: 'destinations',\r\n        title: 'My destinations',\r\n        visible: true,\r\n        minResolution: 200,\r\n        source: countriesSource\r\n    });\r\n\r\n    var missingDataLayer = new ol.layer.Vector({\r\n        name: 'missingData',\r\n        title: 'Missing data',\r\n        visible: false,\r\n        minResolution: 200,\r\n        source: countriesSource\r\n    });  \r\n    \r\n    // Layer groups\r\n    var roadBaselayers = new ol.layer.Group({\r\n        name: 'roadBaselayers',\r\n        layers: [\r\n            openSeaMapLayer,\r\n            openCycleMapLayer,\r\n            mapquestOSMLayer,\r\n            openStreetMapLayer\r\n        ]\r\n    });\r\n\r\n    var reliefBaselayers = new ol.layer.Group({\r\n        name: 'reliefBaselayers',\r\n        layers: [\r\n            stamenTerrainWithLabelsLayer,\r\n            arcgisLayer\r\n        ]\r\n    });\r\n\r\n    var aerialBaselayers = new ol.layer.Group({\r\n        name: 'aerialBaselayers',\r\n        layers: [\r\n            mapquestSatLayer\r\n        ]\r\n    });\r\n\r\n    var baselayers = new ol.layer.Group({\r\n        name: 'baseLayers',\r\n        layers: [\r\n            aerialBaselayers,\r\n            reliefBaselayers,\r\n            roadBaselayers\r\n        ]\r\n    });\r\n\r\n    var userOverlays = new ol.layer.Group({\r\n        name: 'userOverlays',\r\n        layers: [\r\n            destinationsLayer,\r\n            missingDataLayer,\r\n            scoresLayer\r\n        ]\r\n    });\r\n\r\n    var overlays = new ol.layer.Group({\r\n        name: 'overlays',\r\n        layers: [\r\n            userOverlays,\r\n            // toolOverlays,\r\n            // euroveloRoutesOverlay,\r\n            informationOverlays,\r\n            // terrainOverlays,\r\n            roadOverlays\r\n        ]\r\n    });\r\n    \r\n    var layers = [\r\n            baselayers,\r\n            overlays\r\n            // markerOverlays\r\n        ];\r\n\r\n    appModule.deferred.ready.mapLayers.resolve();\r\n\r\n    \r\n    \r\n    var map;\r\n\r\n    // \"EPSG:3857\" Spherical Mercator used by Google Maps, OpenStreetMap, Bing; unit is meter (see http://epsg.io/3857)\r\n    // \"EPSG:4326\" World Geodetic System used in GPS; unit is longitude, latitude (see http://epsg.io/4326)\r\n    var projection = ol.proj.get('EPSG:3857'); // EPSG:3857 EPSG:4326\r\n    // var projection = view.getProjection()\r\n\r\n    // var extent = [0, 0, 180, 85];\r\n    // var extent = ol.proj.transformExtent([-180, -90, 180, 90], 'EPSG:4326', 'EPSG:3857');\r\n    var extent = projection.getExtent();\r\n\r\n    // var center =  ol.proj.transform([6.4090530, 46.0780249], 'EPSG:4326', 'EPSG:3857');\r\n    var center = ol.extent.getCenter(extent);\r\n\r\n    var view = new ol.View({\r\n        center: center,\r\n        extent: extent,\r\n        maxResolution: 39135.76,\r\n        projection: projection,\r\n        zoom: 0\r\n        // minZoom: 4,\r\n        // maxZoom: 16\r\n        // resolutions: [65536, 32768, 16384, 8192, 4096, 2048],\r\n        // resolutions: [9784, 2446, 1223, 76.44, 9.55, 2.39]\r\n    });\r\n\r\n    $.when(appModule.deferred.ready.mapControls, appModule.deferred.ready.mapInteractions, appModule.deferred.ready.mapLayers, appModule.deferred.ready.mapOverlays).done(function () {\r\n        $(function () {\r\n    \r\n            // Auto save/restore form fields with cookies\r\n            // console.time('sayt initialized for #settings_form, #position_form');\r\n            // $('#settings_form, #position_form').sayt(appModule.options.sayt);\r\n            // console.timeEnd('sayt initialized for #settings_form, #position_form');\r\n\r\n            var mapElement = document.getElementById('map');\r\n            //map.setProperties({\r\n            //    target: mapElement\r\n            //});\r\n            // Initialize map\r\n            map = new ol.Map({\r\n                logo: false,\r\n                view: view,\r\n                controls: mapControlsModule.controls,\r\n                interactions: mapInteractionsModule.interactions,\r\n                layers: layers,\r\n                overlays: mapOverlaysModule.overlays,\r\n                // renderer: renderer, // dom webgl canvas ol.RendererHint.CANVAS\r\n                target: mapElement,\r\n                loadTilesWhileInteracting: true\r\n            });\r\n        \r\n            var noWebglInfo = document.getElementById('no-webgl');\r\n\r\n            if (!ol.has.WEBGL) {\r\n                noWebglInfo.style.display = '';\r\n                // var renderer = 'canvas';\r\n            } else {\r\n                // var renderer = 'webgl';\r\n            }\r\n        \r\n            // Redraw the map when the map tab pane become visible\r\n            $('a[data-toggle=\"tab\"]').on('shown.bs.tab', function (e) {\r\n                var pane_id = $(e.target).attr('href');\r\n                if (pane_id === '#map_pane') {\r\n\r\n                    // $.when(appModule.countriesData, appModule.deferred.ready.userProfile, appModule.deferred.ready.priorities).done(function () {\r\n                        // alert('refresh map');\r\n                        scoreModule.updateScores();\r\n                        map.updateSize();\r\n                        scoresLayer.changed();\r\n                        destinationsLayer.changed();\r\n                        // map.renderSync();\r\n                        // map.on('postcompose', render);\r\n                        // map.render();\r\n                        mapControlsModule.overviewMapControl.setMap(mapModule.map);\r\n                        console.log('Map refreshed');\r\n                    // });\r\n\r\n                }\r\n            });\r\n            \r\n            // Adapt map controls\r\n            $('.ol-zoom-in, .ol-zoom-out, .ol-overviewmap button[title], .ol-zoom-extent button[title]').tooltip({\r\n                placement: 'right'\r\n            });\r\n            $('.ol-rotate-reset, .ol-attribution button[title], .ol-full-screen button[title], .layer-switcher button[title]').tooltip({\r\n                placement: 'left'\r\n            });\r\n            $('.layer-switcher button').addClass('ol-control');\r\n\r\n            \r\n            /*var $el = $('.navmenu');\r\n            $el.on('shown.bs.offcanvas', function (e) {\r\n\r\n            });*/\r\n\r\n            // appModule.initBlock('[data-anchor=\"map\"]');\r\n            \r\n            mapModule.map = map;\r\n            \r\n            appModule.deferred.ready.map.resolve();\r\n            console.timeEnd('Map initialized');\r\n    \r\n        });\r\n    });\r\n    \r\n    // Update some layer styles once appModule.countriesData loaded\r\n    $.when(appModule.countriesData).then(function () {\r\n        \r\n        scoresLayer.setProperties({\r\n            style: scoreStyleFunction\r\n        });\r\n\r\n        destinationsLayer.setProperties({\r\n            style: destinationStyleFunction\r\n        });\r\n\r\n        missingDataLayer.setProperties({\r\n            style: missingDataStyleFunction\r\n        });\r\n        \r\n        console.log('Map styles updated'); \r\n        \r\n    });\r\n    \r\n    \r\n    \r\n    // Translate layer and group titles once i18next plugin initialized\r\n    $.when(appModule.deferred.init.i18next).done(function () {\r\n        \r\n        roadBaselayers.setProperties({\r\n            title: appModule.i18n.t('sections:roadLayers.title')\r\n        });\r\n\r\n        reliefBaselayers.setProperties({\r\n            title: appModule.i18n.t('sections:roadWithReliefLayers.title')\r\n        });\r\n\r\n        aerialBaselayers.setProperties({\r\n            title: appModule.i18n.t('sections:satelliteLayers.title')\r\n        });\r\n\r\n        baselayers.setProperties({\r\n            title: appModule.i18n.t('sections:baseLayer.title')\r\n        });\r\n\r\n        roadOverlays.setProperties({\r\n            title: appModule.i18n.t('sections:roadLayers.title')\r\n        });\r\n\r\n        informationOverlays.setProperties({\r\n            title: appModule.i18n.t('sections:infoLayers.title')\r\n        });\r\n\r\n        /*terrainOverlays.setProperties({\r\n            title: appModule.i18n.t('sections:reliefLayers.title')\r\n        });*/\r\n\r\n        userOverlays.setProperties({\r\n            title: appModule.i18n.t('sections:myLayers.title')\r\n        });\r\n\r\n        overlays.setProperties({\r\n            title: appModule.i18n.t('sections:overlayLayers.title')\r\n        });\r\n\r\n        informationOverlays.setProperties({\r\n            title: appModule.i18n.t('sections:infoLayers.title')\r\n        });\r\n        \r\n        console.log('Map layers translated'); \r\n       \r\n        // Tooltips translation\r\n        //$('#map .ol-zoom-in[data-original-title]').attr('data-original-title', appModule.i18n.t('buttons:olZoomIn.label'));\r\n        //$('#map .ol-zoom-out[data-original-title]').attr('data-original-title', appModule.i18n.t('buttons:olZoomOut.label'));\r\n            \r\n    });\r\n    \r\n\r\n    \r\n    $(function () {\r\n\r\n        $.when(appModule.deferred.ready.map).done(function () {\r\n            \r\n            mapInputsModule.zoom('#zoom', mapModule.map);\r\n            mapInputsModule.resolution('#resolution', mapModule.map);\r\n            mapInputsModule.rotation('#rotation', mapModule.map);\r\n            mapInputsModule.center('#center_x', '#center_y', mapModule.map);\r\n            mapInputsModule.exportPNG('#export-png', mapModule.map);\r\n\r\n            // GPS mode\r\n            var $gpsMode = $('#gps_mode');\r\n            $gpsMode.on('switchChange.bootstrapSwitch init', function () { // e, state\r\n                if (this.checked) {\r\n                    var view = mapModule.map.getView();\r\n                    view.setZoom(14);\r\n                    console.log('Zoom increased');\r\n                }\r\n            });\r\n\r\n        });\r\n\r\n    });\r\n    \r\n    \r\n    \r\n    return {\r\n        map: map,\r\n        render: render,\r\n        centerMap: centerMap,\r\n        fitCountry: fitCountry\r\n    };\r\n    \r\n})();\r\n"]}